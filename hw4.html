<!DOCTYPE html>
<html>

<head>
    <style type="text/css">

    </style>

    <title>XML Parser</title>
</head>

<body style="text-align: center;">
    <p>Enter URL for Company list XML file</p>
    <input type="text" id="url">
    <br>
    <br>
    <input type="submit" value="Submit Query" onclick="testClick()">
    <script type="text/javascript">
        var myWindow;
        var network_name = document.createTextNode("N.A");

        function handleServerResponse() {
            if (xmlhttp.readyState == 4) {
                if (xmlhttp.status == 200) {
                    return 1;
                } else if (xmlhttp.status == 404) {
                    alert("File does not exist");
                }
            }
        }

        function testClick() {
            var xmlDoc;
            var url = document.getElementById("url").value;
            if (url == "") {
                alert("Please enter URL in the text box to continue");
            } else {
                if (window.XMLHttpRequest) {
                    // code for IE7+, Firefox, Chrome, Opera, Safari
                    xmlhttp = new XMLHttpRequest();
                } else {
                    // code for IE6, IE5
                    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
                }
                xmlhttp.onreadystatechange = handleServerResponse;
                xmlhttp.open("GET", url, false); //open, send, responseXML are
                xmlhttp.send(); //properties of XMLHTTPRequest
                xmlDoc = xmlhttp.responseXML;
                if (xmlDoc.getElementsByTagName("parsererror").length > 0) {
                    alert("Invalid file");
                } else {
                    var rows = xmlDoc.getElementsByTagName("Row");
                    if (rows.length > 0) {
                        var data = xmlDoc.getElementsByTagName("Data");
                        myWindow = window.open("", "myWindow", "width=900, height=600, scrollbars=1");
                        myWindow.document.write("<table border='1'><tr>");
                        for (i = 0; i < data.length; i++) {
                            myWindow.document.write("<th>");
                            myWindow.document.write(data[i].childNodes[0].nodeValue);
                            myWindow.document.write("</th>");
                        }
                        myWindow.document.write("</tr>");
                        for (i = 0; i < rows.length; i++) {
                            myWindow.document.write("<tr><td>");
                            try {
                                myWindow.document.write(rows[i].getElementsByTagName("Network")[0].childNodes[0].nodeValue);
                            } catch (err) {
                                rows[i].getElementsByTagName("Network")[0].appendChild(network_name);
                                myWindow.document.write(rows[i].getElementsByTagName("Network")[0].childNodes[0].nodeValue);
                            }
                            myWindow.document.write("</td><td>");
                            try {
                                myWindow.document.write(rows[i].getElementsByTagName("Owner")[0].childNodes[0].nodeValue);
                            } catch (err) {
                                rows[i].getElementsByTagName("Owner")[0].appendChild(network_name);
                                myWindow.document.write(rows[i].getElementsByTagName("Owner")[0].childNodes[0].nodeValue);
                            }
                            myWindow.document.write("</td><td>");
                            var feeds = rows[i].getElementsByTagName("Feed");
                            for (j = 0; j < feeds.length; j++) {

                                try {
                                    var val = feeds[j].childNodes[0].nodeValue;
                                    val = val.replace(/\s+/g, '');
                                    if (val != "")
                                    {
                                        myWindow.document.write("<ul><li>");
                                        myWindow.document.write(feeds[j].childNodes[0].nodeValue);
                                    }
                                } catch (err) {
                                    console.log(err);
                                }
                                myWindow.document.write("</li></ul>");
                            }
                            myWindow.document.write("</td><td>");
                            try {
                                myWindow.document.write(rows[i].getElementsByTagName("Notes")[0].childNodes[0].nodeValue);
                            } catch (err) {
                                rows[i].getElementsByTagName("Notes")[0].appendChild(network_name);
                                myWindow.document.write(rows[i].getElementsByTagName("Notes")[0].childNodes[0].nodeValue);
                            }
                            myWindow.document.write("</td><td><a href='");
                            try {
                                myWindow.document.write(rows[i].getElementsByTagName("HomePage")[0].childNodes[0].nodeValue);
                            } catch (err) {
                                var hash = document.createTextNode("#");
                                rows[i].getElementsByTagName("HomePage")[0].appendChild(hash);
                                myWindow.document.write(rows[i].getElementsByTagName("HomePage")[0].childNodes[0].nodeValue);
                            }
                            myWindow.document.write("'>");
                            try {
                                myWindow.document.write(rows[i].getElementsByTagName("HomePage")[0].childNodes[0].nodeValue);
                            } catch (err) {
                                rows[i].getElementsByTagName("HomePage")[0].appendChild(network_name);
                                myWindow.document.write(rows[i].getElementsByTagName("HomePage")[0].childNodes[0].nodeValue);
                            }
                            myWindow.document.write("</a></td><td><img src='");
                            try {
                                myWindow.document.write(rows[i].getElementsByTagName("Logo")[0].childNodes[0].nodeValue);
                            } catch (err) {
                                var image_alt = document.createTextNode("Image not available");
                                myWindow.document.write("#' width='100' height='100' alt='");
                                rows[i].getElementsByTagName("Logo")[0].appendChild(image_alt);
                                myWindow.document.write(rows[i].getElementsByTagName("Logo")[0].childNodes[0].nodeValue);
                            }
                            myWindow.document.write("'></td></tr>");
                        }
                        myWindow.document.write("</table>");
                        myWindow.document.close();
                    }
                    else {
                        alert("Empty network list");
                    }
                }
            }
        }
    </script>
    <noscript>
</body>
</html>