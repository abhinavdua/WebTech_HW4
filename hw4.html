<!DOCTYPE html>
<html>
<head>
<style type="text/css">
</style>

	<title>XML Parser</title>
</head>
<body style="text-align: center;">
<p>Enter URL for Company list XML file</p>
<input type="text" id="url"><br><br>
<input type="submit" value="Submit Query" onclick="testClick()">
<script type="text/javascript">
			
			var myWindow;

			function handleServerResponse() {
					if (xmlhttp.readyState ==4) {
						if (xmlhttp.status == 200) {
					    	return 1;
						}
					    else if (xmlhttp.status == 404) {
					    	alert("Sorry, the requested file does not exist");
					    }
					}
			}
			function testClick() {
			var xmlDoc;
			var url = document.getElementById("url").value;
			if (url == "") {
				alert("Please enter URL in the text box to continue");
			}
			else {
				if (window.XMLHttpRequest)
				 {
				 	// code for IE7+, Firefox, Chrome, Opera, Safari
				 	xmlhttp = new XMLHttpRequest();
				 }
				 else
				 {
				 	// code for IE6, IE5
				 	xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
				 }
				 xmlhttp.onreadystatechange=handleServerResponse; 
				 xmlhttp.open("GET",url,false); //open, send, responseXML are
				 xmlhttp.send(); //properties of XMLHTTPRequest
				 xmlDoc=xmlhttp.responseXML;
				 if(xmlDoc.getElementsByTagName("parsererror").length>0){
				 	alert("Error parsing XML");
				 }
				 else {
				 	var rows = xmlDoc.getElementsByTagName("Row");
				 	var data = xmlDoc.getElementsByTagName("Data");
				 	myWindow = window.open("", "myWindow", "width=900, height=600");
				 	myWindow.document.write("<table border='1'><tr>");
					 for (i = 0; i < data.length; i++) {
					 	myWindow.document.write("<th>");
					 	myWindow.document.write(data[i].childNodes[0].nodeValue);
					 	myWindow.document.write("</th>");
					 }
					 myWindow.document.write("</tr>");
					 for (i = 0; i < rows.length; i++)
					 { 
						myWindow.document.write("<tr><td>");
						myWindow.document.write(rows[i].getElementsByTagName("Network")[0].childNodes[0].nodeValue);
						myWindow.document.write("</td><td>");
						myWindow.document.write(rows[i].getElementsByTagName("Owner")[0].childNodes[0].nodeValue);
						myWindow.document.write("</td><td>");
						var feeds = rows[i].getElementsByTagName("Feed");
					 	for (j=0; j< feeds.length; j++) {
					 	  	myWindow.document.write("<ul><li>");
							myWindow.document.write(feeds[j].childNodes[0].nodeValue);
							myWindow.document.write("</li></ul>");
							}
						myWindow.document.write("</td><td>");
						myWindow.document.write(rows[i].getElementsByTagName("Notes")[0].childNodes[0].nodeValue);
						myWindow.document.write("</td><td><a href='");
						myWindow.document.write(rows[i].getElementsByTagName("HomePage")[0].childNodes[0].nodeValue);
						myWindow.document.write("'>");
						myWindow.document.write(rows[i].getElementsByTagName("HomePage")[0].childNodes[0].nodeValue);
						myWindow.document.write("</a></td><td><img src='");
						myWindow.document.write(rows[i].getElementsByTagName("Logo")[0].childNodes[0].nodeValue);
						myWindow.document.write("'></td></tr>");
					  }
					myWindow.document.write("</table>");
					myWindow.document.close();
				 }
				 
				
			}
		}
	
</script>
<noscript>
</body>
</html>